version: "1.0"
name: "mcp-server"

# Authentication
auth:
  api_keys:
    - name: "main"
      key_hash: "sha256:1af16067fc0f37f16a54d69f103ca7e9fa71db70621ef24d8dfc75181263b0f1"
      permissions: ["*"]

# MCP Registry
mcps:
  # External MCPs (HTTP-based, proxied through server)
  external:
    - name: "github"
      url: "https://api.githubcopilot.com/mcp/"
      auth:
        type: "bearer"
        token: "${GITHUB_PERSONAL_ACCESS_TOKEN}"
      enabled: true

    - name: "linear"
      url: "https://mcp.linear.app/mcp"
      auth:
        type: "none"
      enabled: true

    - name: "greptile"
      url: "https://api.greptile.com/mcp"
      auth:
        type: "bearer"
        token: "${GREPTILE_API_KEY}"
      enabled: true

  # Local MCPs (npm packages or local servers)
  local:
    - name: "context7"
      command: "npx"
      args: ["-y", "@upstash/context7-mcp"]
      enabled: true

    - name: "typescript-lsp"
      command: "typescript-language-server"
      args: ["--stdio"]
      enabled: true

# Skills (instruction sets / agent prompts)
skills:
  - name: "code-simplifier"
    description: "Agent that simplifies and refines code for clarity, consistency, and maintainability"
    file: "./plugins/code-simplifier/agents/code-simplifier.md"
    tags: ["refactoring", "code-quality"]

# Plugins (local plugins with hooks, commands, agents)
plugins:
  - name: "hookify"
    description: "Create hooks to prevent unwanted behaviors"
    path: "./plugins/hookify"
    runtime: "python"
    enabled: true

  - name: "ralph-loop"
    description: "Continuous self-referential AI loops for iterative development"
    path: "./plugins/ralph-loop"
    runtime: "shell"
    enabled: true

# Hooks (event handlers from plugins)
hooks:
  # Hookify hooks
  - name: "hookify-userpromptsubmit"
    trigger: "user.prompt.submit"
    action: "./plugins/hookify/hooks/userpromptsubmit.py"

  - name: "hookify-pretooluse"
    trigger: "tool.pre"
    action: "./plugins/hookify/hooks/pretooluse.py"

  - name: "hookify-posttooluse"
    trigger: "tool.post"
    action: "./plugins/hookify/hooks/posttooluse.py"

  # Ralph-loop hooks
  - name: "ralph-stop"
    trigger: "stop"
    action: "./plugins/ralph-loop/hooks/stop-hook.sh"

# IDE/Client Configurations
configs:
  claude:
    file: "./configs/CLAUDE.md"
  codex:
    file: "./configs/AGENTS.md"

# Secrets (environment variables needed)
secrets:
  provider: "env"
  required:
    - GITHUB_PERSONAL_ACCESS_TOKEN  # For GitHub MCP
    - GREPTILE_API_KEY              # For Greptile MCP
  optional:
    - LINEAR_API_KEY                # Linear uses OAuth, but API key can be used
